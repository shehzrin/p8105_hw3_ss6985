P8105 Homework 3
================
Shehzrin Shah
2024-10-12

## Problem 1

Loading the data from the `p8105.datasets` package:

``` r
data("ny_noaa")
summary(ny_noaa)
```

    ##       id                 date                 prcp               snow       
    ##  Length:2595176     Min.   :1981-01-01   Min.   :    0.00   Min.   :  -13   
    ##  Class :character   1st Qu.:1988-11-29   1st Qu.:    0.00   1st Qu.:    0   
    ##  Mode  :character   Median :1997-01-21   Median :    0.00   Median :    0   
    ##                     Mean   :1997-01-01   Mean   :   29.82   Mean   :    5   
    ##                     3rd Qu.:2005-09-01   3rd Qu.:   23.00   3rd Qu.:    0   
    ##                     Max.   :2010-12-31   Max.   :22860.00   Max.   :10160   
    ##                                          NA's   :145838     NA's   :381221  
    ##       snwd            tmax               tmin          
    ##  Min.   :   0.0   Length:2595176     Length:2595176    
    ##  1st Qu.:   0.0   Class :character   Class :character  
    ##  Median :   0.0   Mode  :character   Mode  :character  
    ##  Mean   :  37.3                                        
    ##  3rd Qu.:   0.0                                        
    ##  Max.   :9195.0                                        
    ##  NA's   :591786

The dataset being explored is the `ny_noaa` dataset from the
`p8105.datasets` package. It contains a total of 2595176 rows and 7
columns, representing daily weather observations from various locations
in New York state. The columns include:

- `id`: a station identifier
- `date`: the date of the observation
- `prcp`: precipitation (tenths of mm)
- `snow`: snowfall (mm)
- `snwd`: snow depth (mm)
- `tmax`: maximum temperature (tenths of degrees C)
- `tmin`: minimum temperature (tenths of degrees C)

Looking at the original dataset, we see it contains substantial amount
of missing data (lots of `NA` values across variables as seen from data
and `summary` command). There are 3387623 missing values in the dataset.

### Data cleaning:

``` r
noaatidy_df = ny_noaa |>
  janitor::clean_names() |>
  separate(date, into = c("year", "month", "day"), convert = TRUE) |>
  mutate(
    prcp = prcp / 10 ,
    tmax = as.numeric(tmax) / 10,
    tmin = as.numeric(tmin) / 10,
    year = as.numeric(year),
    day = as.numeric(day),
    month = recode_factor(month,
          "01" = "January",
          "02" = "February",
          "03" = "March",
          "04" = "April",
          "05" = "May",
          "06" = "June",
          "07" = "July",
          "08" = "August",
          "09" = "September",
          "10" = "October",
          "11" = "November",
          "12" = "December"
    ))
```

In the data cleaning step, we cleaned the variables names, created
separate variables for year, month, and day, and converted these
variables to numeric variables. Additionally, variables measured in
tenths of units were converted into just units (e.g., `tmin` was
measured in tenths of degrees C and converted into degrees C).

``` r
noaatidy_df |>
  filter(!is.na(snow)) |>            
  group_by(snow) |>                 
  summarize(count = n()) |>        
  arrange(desc(count)) 
```

    ## # A tibble: 281 × 2
    ##     snow   count
    ##    <int>   <int>
    ##  1     0 2008508
    ##  2    25   31022
    ##  3    13   23095
    ##  4    51   18274
    ##  5    76   10173
    ##  6     8    9962
    ##  7     5    9748
    ##  8    38    9197
    ##  9     3    8790
    ## 10   102    6552
    ## # ℹ 271 more rows

For snowfall, the most commonly observed value is O (no recorded
snowfall on most days in NY state). This makes sense because snowfall
only occurs during certain times of the year and in specific conditions
(i.e., there are many days with no snowfall, and a small window for
possible snow).

### Making two-panel plot:

``` r
avg_temp_df = noaatidy_df %>% 
  filter(month %in% c("January", "July")) %>% 
  group_by(id, year, month) %>% 
  summarize(avg_tmax = mean(tmax, na.rm = TRUE))
```

    ## `summarise()` has grouped output by 'id', 'year'. You can override using the
    ## `.groups` argument.

``` r
ggplot(avg_temp_df, aes(x = year, y = avg_tmax, color = month)) +
  geom_point(alpha = 0.2) +
  geom_smooth(alpha = 0.5) +
  labs(
    title = "Average Maximum Temperature in January and July by Station",
    x = "Year",
    y = "Average Max Temperature (°C)",
  ) +
  scale_x_continuous(
    breaks = c(1980, 1985, 1990, 1995, 2000, 2005, 2010)
    ) +
  facet_grid(. ~ month) +
  viridis::scale_color_viridis(discrete = TRUE) +
  theme(
    legend.position = "none")
```

    ## `geom_smooth()` using method = 'gam' and formula = 'y ~ s(x, bs = "cs")'

    ## Warning: Removed 5970 rows containing non-finite outside the scale range
    ## (`stat_smooth()`).

    ## Warning: Removed 5970 rows containing missing values or values outside the scale range
    ## (`geom_point()`).

![](p8105_hw3_ss6985_files/figure-gfm/unnamed-chunk-4-1.png)<!-- --> The
two-panel plot shows the average maximum temperature in January and July
across years by station. July temperatures remain stable around 25–30°C,
with fewer outliers (e.g., one possible at about 14ºC), overall ranging
from about 20ºC and 35ºC. Seasonal patterns are evident in January,
while July shows less variation. January temperatures fluctuate more
(within approximately -10 to 10ºC), with some potential outliers (e.g.,
lowest max temperature at about -14ºC). There does not appear to be a
significant difference in average max temperatures in July or January
throughout the years. The average temperatures in January (winter month)
are also lower than in July (summer month).

### Making more two-panel plots:

``` r
tmax_tmin_df = noaatidy_df |>
  filter(!is.na(tmax), !is.na(tmin)) |>
  ggplot(aes(x = tmin, y = tmax)) +
  geom_hex(bins = 40) +
  geom_smooth(se = FALSE) +
  viridis::scale_color_viridis(discrete = TRUE) + 
  labs(
    title = "Maximum vs Minimum Temperatures",
    x = "Minimum Temperature (°C)",
    y = "Maximum Temperature (°C)"
  ) + 
  theme_minimal() + 
  theme(legend.position = "bottom")

tmax_tmin_df
```

    ## `geom_smooth()` using method = 'gam' and formula = 'y ~ s(x, bs = "cs")'

![](p8105_hw3_ss6985_files/figure-gfm/unnamed-chunk-5-1.png)<!-- -->

``` r
snowfall_df = noaatidy_df |>
  filter(snow > 0, snow < 100) %>% 
  ggplot(aes(x = snow, y = factor(year), fill = stat(x))) +
  geom_density_ridges_gradient(scale = 3, rel_min_height = 0.01) + 
  scale_fill_viridis_c(name = "Snowfall (mm)", option = "A") + 
  labs(
    title = "Distribution of Snowfall (0 < Snow < 100) by Year",
    x = "Snowfall (mm)",
    y = "Year"
  )

snowfall_df
```

    ## Warning: `stat(x)` was deprecated in ggplot2 3.4.0.
    ## ℹ Please use `after_stat(x)` instead.
    ## This warning is displayed once every 8 hours.
    ## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was
    ## generated.

    ## Picking joint bandwidth of 3.76

![](p8105_hw3_ss6985_files/figure-gfm/unnamed-chunk-5-2.png)<!-- -->

The first two-panel plot (hex plot) shows the `tmax` vs `tmin` for the
full dataset. The plot shows denser regions at moderate maximum
temperatures (around 0ºC to 35ºC) and minimum temperatures (around -10ºC
to 20ºC), suggesting most observations fall within that range.

The second two-panel plot shows the distribution of snowfall (values
greater than 0 and less than 100) separately by year. The ridgeline plot
shows distributions across years with most snowfall events concentrated
around 0-40mm. The overall patterns suggests a fairly consistent
distribution of snowfall values below 50mm even with some variability
across the years.
